angular.module("configs",[]).constant("API",{}).constant("localImgUrl","../img/").constant("serverImgUrl","http://localhost:3333/img/"),angular.module("services",["ngCordova"]).factory("Chats",[function(){var t=[{id:0,name:"Ben Sparrow",lastText:"You on your way?",face:"img/ben.png"},{id:1,name:"Max Lynx",lastText:"Hey, it's me",face:"img/max.png"},{id:2,name:"Adam Bradleyson",lastText:"I should buy a boat",face:"img/adam.jpg"},{id:3,name:"Perry Governor",lastText:"Look at my mukluks!",face:"img/perry.png"},{id:4,name:"Mike Harrington",lastText:"This is wicked good ice cream.",face:"img/mike.png"}];return{all:function(){return t},remove:function(n){t.splice(t.indexOf(n),1)},get:function(n){for(var e=0;e<t.length;e++)if(t[e].id===parseInt(n))return t[e];return null}}}]).factory("$icu",["$ionicHistory","$ionicScrollDelegate","$http","$ionicModal","$ionicPopup","$ionicLoading","$state","$ionicPopover","$location","$ionicActionSheet","$ionicTabsDelegate","$cordovaStatusbar",function(t,n,e,o,i,a,s,l,r,c,u,d){var p=null,m=null;return{platform:ionic.Platform.platform(),alert:function(t,n){p||(p=i.alert({title:t.title||"提示",subTitle:t.subT||null,template:t.tpl,okText:t.text||"我知道啦~",cssClass:t.class||"",okType:t.type}),p.then(function(){n&&n(),p=null}))},confirm:function(t,n,e){p||(p=i.confirm({template:t.tpl,title:t.title||"提示",subTitle:t.subT||null,cancelText:t.cText||"取消",okText:t.oText||"确定",okType:t.oType||"",cancelType:t.cType||"",cssClass:t.class||""}),p.then(function(t){t?n&&n():e&&e(),p=null}))},show:function(t,n){p||(p=i.show({template:t.tpl,title:t.title||"提示",subTitle:t.subT||null,scope:t.scope||null,cssClass:t.class||"",buttons:n}))},sheet:function(t,n,e,o){m=c.show({buttons:t.buttons,cssClass:t.class,cancelOnStateChange:t.flag||!0,destructiveText:t.dText||"删除",titleText:t.title,cancelText:t.cText||"取消",destructiveButtonClicked:function(){o&&o()},cancel:function(){e&&e()},buttonClicked:function(t){return n&&n(t),!0}})},hint:function(t,n){a.show({template:t.tpl||"载入中...",scope:t.scope,noBackdrop:t.bg,delay:t.delay,duration:t.time||2500}).then(function(){n&&n()})},modal:function(t,n,e){o.fromTemplateUrl(t.url,{scope:t.scope,animation:t.animation||"slide-in-up",focusFirstInput:t.focus||!0}).then(function(o){t.scope.modal=o,t.scope.$on("$destroy",function(){t.scope.modal.remove()}),t.scope.$on("modal.hidden",function(){e&&e()}),t.scope.$on("modal.shown",function(){n&&n()})})},popover:function(t,n,e){l.fromTemplate(t.tpl,{scope:t.scope,focusFirstInput:t.focus||!0}).then(function(o){t.scope.popover=o,t.scope.showPopover=function(n){t.scope.popover.show(n)},t.scope.$on("$destroy",function(){t.scope.popover.remove()}),t.scope.$on("popover.shown",function(){n&&n()}),t.scope.$on("popover.hidden",function(){e&&e()})})},clearHistory:function(){t.clearHistory()},back:function(n){t.goBack(n)},go:function(t){s.go(t)},scrollBottom:function(t,e){e?n.$getByHandle(e).scrollBottom(!!t):n.scrollBottom(!!t)},scrollTop:function(t,e){e?n.$getByHandle(e).scrollTop(!!t):n.scrollTop(!!t)},resize:function(t){t?n.$getByHandle(t).resize():n.resize()},setStatusBarStyle:function(t){"ios"==this.platform&&(t=Number(t)||0,d.style(t))},showTab:function(t){u.showBar(t)},getPath:function(){return r.path()},getNetworkState:function(){return navigator.connection.type},showToast:function(t,n,e){window.plugins&&window.plugins.toast&&window.plugins.toast.showWithOptions({message:t.msg||"",duration:t.time||"short",position:t.position||"center",addPixelsY:t.offset||0,data:t.data||{},styling:{opacity:t.style&&t.style.opa?t.style.opa:.8,backgroundColor:t.style&&t.style.bg?t.style.bg:"#333333",textSize:t.style&&t.style.size?t.style.size:13,textColor:t.style&&t.style.color?t.style.color:"#FFFFFF",cornerRadius:t.style&&t.style.radius?t.style.radius:20,horizontalPadding:t.style&&t.style.hPadding?t.style.hPadding:50,verticalPadding:t.style&&t.style.vPadding?t.style.vPadding:30}},function(t){n&&n(t)},function(t){e&&e()})},ajax:function(t,n,o,i){this.getNetworkState()!=Connection.NONE?e({url:t+"?callback=JSON_CALLBACK",method:"JSONP",params:n}).then(function(t){o&&o(t)},function(t){i&&i(t)}).finally(function(){}):this.showToast({msg:"无网络连接，请检查您的网络是否正常",position:"bottom"})},call:function(t,n){var e=this;window.plugins&&window.plugins.CallNumber?(t="ios"==e.platform?"tel:"+t:t,window.plugins.CallNumber.callNumber(function(){n&&n()},function(){e.showToast({msg:"拨打电话失败"})},t)):e.showToast({msg:"拨打电话失败"})}}}]).factory("$storage",[function(){return{s:window.localStorage,get:function(t){return!!this.s.getItem(t)&&JSON.parse(this.s.getItem(t))},set:function(t,n){"object"==typeof n?this.s.setItem(t,JSON.stringify(n)):this.s.setItem(t,n)},remove:function(t){this.s.removeItem(t)},clear:function(){this.s.clear()}}}]).factory("$time",["$interval",function(t){return{format:function(t){return t=t.toString(),1==t.length?"0"+t:t},countDown:function(n,e){var o,i=this,a=n.second?Number(n.second):0,s=n.minute?Number(n.minute):0,l=n.hour?Number(n.hour):0;o=t(function(){if(0==a)if(s>0)a=60,s--;else{if(!(l>0))return t.cancel(o),void(e&&e());a=60,s=59,l--}a--,n.hour=i.format(l),n.minute=i.format(s),n.second=i.format(a)},1e3)},toTime:function(t){var n={},e=Math.floor(t/1e3);return n.hour=Math.floor(e/3600),n.minute=Math.floor(e%3600/60),n.second=e-60*n.minute-3600*n.hour,n}}}]).factory("User",["$icu",function(t){return{hasLogin:!1,hasReg:!1,login:function(){this.hasLogin=!0,t.go("tab.recommend")},register:function(){this.hasReg=!0}}}]).factory("Carts",["$icu",function(t){return{count:12,cart:[],getCart:function(){},deleteCart:function(){this.count-=1},addCart:function(){this.count+=1}}}]),angular.module("filters",[]).filter("price",[function(){return function(t){return isNaN(Number(t))?t:"￥"+Number(t).toFixed(2)}}]),angular.module("directives",[]).directive("hideTab",["$icu",function(t){return{restrict:"A",link:function(n,e,o){n.$on("$ionicView.beforeEnter",function(){t.showTab("false"==o.hideTab)})}}}]).directive("statusBar",["$icu",function(t){return{restrict:"A",link:function(n,e,o){n.$on("$ionicView.beforeEnter",function(){t.setStatusBarStyle(+o.statusBar)})}}}]).directive("carousel",["$icu","localImgUrl",function(t,n){return{restrict:"E",replace:!0,template:'<div><ion-slide-box show-pager="true" auto-play="true" on-slide-changed="slideHasChanged($index)" does-continue="true" slide-interval="3000"><ion-slide ng-repeat="img in images"><img ng-src="'+n+'{{img}}" width="100%"/></ion-slide></ion-slide-box></div>'}}]).directive("sumBar",["$icu",function(t){return{restrict:"E",replace:!0,template:'<div class="bar row row-center bar-footer bar-stable"><div class="col col-80"><div><div class="col col-20"></div></div>',link:function(t,n,e){}}}]),angular.module("controllers",[]).controller("RecommendCtrl",["$scope","$icu","User","$ionicHistory",function(t,n,e,o){t.$on("$ionicView.beforeEnter",function(){e.hasLogin||n.go("tab.login"),n.clearHistory(),t.images=["perry.png","ben.png","max.png","mike.png"]})}]).controller("CartsCtrl",["$scope","Chats",function(t,n){t.chats=n.all(),t.remove=function(t){n.remove(t)}}]).controller("ChatDetailCtrl",["$scope","$stateParams","Chats",function(t,n,e){t.chat=e.get(n.chatId)}]).controller("MyCtrl",["$scope",function(t){t.settings={enableFriends:!0}}]).controller("LoginCtrl",["$scope","$icu","User",function(t,n,e){t.$on("$ionicView.enter",function(){n.clearHistory()}),t.login=function(){e.login()}}]).controller("EditPasswordCtrl",["$scope","$icu","User",function(t,n,e){t.$on("$ionicView.enter",function(){t.config={phone:"",code:"",psw:""}}),t.editPassword=function(){}}]).controller("RegisterCtrl",["$scope","$icu","User",function(t,n,e){t.$on("$ionicView.enter",function(){t.config={name:"",phone:"",code:"",psw:""}}),t.register=function(){}}]);var app=angular.module("materials",["ionic","ngCordova","configs","services","filters","directives","controllers"]);app.run(["$ionicPlatform","$icu","$rootScope","$ionicHistory","$timeout",function(t,n,e,o,i){t.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),document.addEventListener("offline",function(){n.showToast({msg:"网络已断开，请检查网络连接"})},!1),document.addEventListener("online",function(){n.showToast({msg:"网络已连接"})},!1)}),t.registerBackButtonAction(function(t){return"/tab/login"==n.getPath()||"/tab/recommend"==n.getPath()?e.backButtonPressedOnceToExit?ionic.Platform.exitApp():(e.backButtonPressedOnceToExit=!0,n.showToast({msg:"再按一次返回键退出应用"}),i(function(){e.backButtonPressedOnceToExit=!1},2e3)):o.backView()?n.back():(e.backButtonPressedOnceToExit=!0,n.showToast({msg:"再按一次返回键退出应用"}),i(function(){e.backButtonPressedOnceToExit=!1},2e3)),t.preventDefault(),!1},101)}]),app.config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(t,n,e){e.tabs.style("standard"),e.tabs.position("bottom"),e.templates.maxPrefetch(20),e.spinner.icon("ios-small"),e.backButton.text(""),e.backButton.previousTitleText(!1),e.form.toggle("large"),e.form.checkbox("circle"),e.views.swipeBackEnabled(!1),e.views.forwardCache(!1),e.views.maxCache(20),t.state("tab",{url:"/tab",abstract:!0,templateUrl:"templates/tabs.html"}).state("tab.recommend",{url:"/recommend",views:{"tab-recommend":{templateUrl:"templates/recommend.html",controller:"RecommendCtrl"}}}).state("tab.carts",{url:"/carts",views:{"tab-carts":{templateUrl:"templates/carts.html",controller:"CartsCtrl"}}}).state("tab.chat-detail",{url:"/chats/:chatId",views:{"tab-carts":{templateUrl:"templates/chat-detail.html",controller:"ChatDetailCtrl"}}}).state("tab.my",{url:"/my",views:{"tab-my":{templateUrl:"templates/my.html",controller:"MyCtrl"}}}).state("tab.login",{url:"/login",views:{"tab-my":{templateUrl:"templates/login.html",controller:"LoginCtrl"}}}).state("tab.edit-password",{url:"/edit-password",views:{"tab-my":{templateUrl:"templates/edit-password.html",controller:"EditPasswordCtrl"}}}).state("tab.register",{url:"/register",views:{"tab-my":{templateUrl:"templates/register.html",controller:"RegisterCtrl"}}}),n.otherwise("/tab/recommend")}]),app.run(["$templateCache",function(t){t.put("templates/carts.html",'<ion-view view-title="Chats"  hide-back-button="true" hide-tab="false">\n  <ion-content>\n    <ion-list>\n      <ion-item class="item-remove-animate item-avatar item-icon-right" ng-repeat="chat in chats" type="item-text-wrap" href="#/tab/chats/{{chat.id}}">\n        <img ng-src="{{chat.face}}">\n        <h2>{{chat.name}}</h2>\n        <p>{{chat.lastText}}</p>\n        <i class="icon ion-chevron-right icon-accessory"></i>\n\n        <ion-option-button class="button-assertive" ng-click="remove(chat)">\n          Delete\n        </ion-option-button>\n      </ion-item>\n    </ion-list>\n  </ion-content>\n</ion-view>\n'),t.put("templates/chat-detail.html",'<!--\n  This template loads for the \'tab.friend-detail\' state (app.js)\n  \'friend\' is a $scope variable created in the FriendsCtrl controller (controllers.js)\n  The FriendsCtrl pulls data from the Friends service (service.js)\n  The Friends service returns an array of friend data\n-->\n<ion-view view-title="{{chat.name}}">\n  <ion-content class="padding">\n    <img ng-src="{{chat.face}}" style="width: 64px; height: 64px">\n    <p>\n      {{chat.lastText}}\n    </p>\n  </ion-content>\n</ion-view>\n'),t.put("templates/edit-password.html",'<ion-view view-title="找回密码" hide-tab="true" id="editPasswordView">\n  <ion-content>\n    <form novalidate name="editPswForm">\n      <div class="list">\n        <label class="item item-input">\n          <span class="input-label">手机号</span>\n          <input type="number" name="phone" placeholder="输入您的手机号" ng-pattern="/^1\\d{10}$/" required ng-model="config.phone">\n        </label>\n        <label class="item item-input">\n          <span class="input-label">验证码</span>\n          <input type="number" name="code" placeholder="输入您收到的验证码" ng-pattern="/^\\d{6}$/" ng-model="config.code" required>\n        </label>\n        <label class="item item-input">\n          <span class="input-label">输入新密码</span>\n          <input type="password" name="psw" placeholder="输入您的新密码"  ng-model="config.psw" required>\n        </label>\n      </div>\n    </form>\n    <div class="padding-horizontal">\n      <button class="button button-block button-positive" ng-disabled="editPswForm.phone.$invalid || editPswForm.code.$invalid || editPswForm.psw.$invalid" ng-click="editPassword()">\n        确定修改密码\n      </button>\n    </div>\n  </ion-content>\n</ion-view>\n'),t.put("templates/login.html",'<ion-view view-title="用户登录" hide-tab="true" hide-back-button="true" id="loginView">\n  <ion-content class="has-footer">\n    <div class="list">\n      <label class="item item-input">\n        <span class="input-label">手机号</span>\n        <input type="text" placeholder="输入您的手机号">\n      </label>\n      <label class="item item-input">\n        <span class="input-label">密码</span>\n        <input type="password" placeholder="输入您的密码">\n      </label>\n    </div>\n    <div class="padding-horizontal">\n      <button class="button button-block button-positive" ng-click="login()">登录</button>\n    </div>\n  </ion-content>\n  <div class="bar bar-footer bar-light">\n    <a class="title" href="#/tab/edit-password">忘记密码?</a>\n  </div>\n</ion-view>\n'),t.put("templates/my.html",'<ion-view view-title="Account" hide-back-button="true" hide-tab="false">\n  <ion-content>\n    <ion-list>\n    <ion-toggle  ng-model="settings.enableFriends">\n        Enable Friends\n    </ion-toggle>\n    </ion-list>\n  </ion-content>\n</ion-view>\n'),t.put("templates/recommend.html",'<ion-view view-title="农资超市" hide-tab="false"  hide-back-button="true">\n  <ion-nav-buttons side="secondary">\n    <button class="button button-icon icon ion-search" ng-click="search()"></button>\n  </ion-nav-buttons>\n\n  <ion-content class="has-footer">\n    <carousel></carousel>\n  </ion-content>\n  <div class="bar row row-center bar-footer bar-stable has-tabs sum-bar">\n    <div class="col col-75">\n      <button class="button button-icon icon ion-ios-cart inline-center">\n        <span class="round-badge badge-assertive">12</span>\n      </button>\n      <span class="inline-center">合计：<i class="">￥12312</i></span>\n    </div>\n    <div class="col col-25 tac">\n      <span class="inline-center">结算</span>\n    </div>\n  </div>\n</ion-view>\n'),t.put("templates/register.html",'<ion-view view-title="注册" hide-tab="true" id="registerView">\n  <ion-content>\n    <form novalidate name="registerForm">\n      <div class="list">\n        <label class="item item-input">\n          <span class="input-label">真实姓名</span>\n          <input type="text" name="name" placeholder="请输入您的真实姓名" required ng-model="config.name">\n        </label>\n        <label class="item item-input">\n          <span class="input-label">手机号</span>\n          <input type="number" name="phone" placeholder="请输入您的手机号" ng-pattern="/^1\\d{10}$/" required ng-model="config.phone">\n        </label>\n        <label class="item item-input">\n          <span class="input-label">验证码</span>\n          <input type="number" name="code" placeholder="请输入您收到的验证码" ng-pattern="/^\\d{6}$/" ng-model="config.code" required>\n        </label>\n        <label class="item item-input">\n          <span class="input-label">密码</span>\n          <input type="password" name="psw" placeholder="请输入您的密码"  ng-model="config.psw" required>\n        </label>\n      </div>\n    </form>\n    <div class="padding">\n      <button class="button button-block button-positive" ng-disabled="editPswForm.phone.$invalid || editPswForm.code.$invalid || editPswForm.psw.$invalid" ng-click="register()">\n        注册\n      </button>\n      <p class="fs12">点击上面的“注册”按钮，即表示您同意<a>花云用户协议</a></p>\n    </div>\n  </ion-content>\n</ion-view>\n'),t.put("templates/tabs.html",'<!--\nCreate tabs with an icon and label, using the tabs-positive style.\nEach tab\'s child <ion-nav-view> directive will have its own\nnavigation history that also transitions its views in and out.\n-->\n<ion-tabs class="tabs-icon-top tabs-color-active-positive">\n\n  <ion-tab title="常用" icon-off="ion-ios-pulse" icon-on="ion-ios-pulse-strong" href="#/tab/recommend">\n    <ion-nav-view name="tab-recommend"></ion-nav-view>\n  </ion-tab>\n\n  <ion-tab title="购物车" icon-off="ion-ios-chatboxes-outline" icon-on="ion-ios-chatboxes" href="#/tab/carts">\n    <ion-nav-view name="tab-carts"></ion-nav-view>\n  </ion-tab>\n\n  <ion-tab title="我的" icon-off="ion-ios-gear-outline" icon-on="ion-ios-gear" href="#/tab/my">\n    <ion-nav-view name="tab-my"></ion-nav-view>\n  </ion-tab>\n\n\n</ion-tabs>\n')}]);